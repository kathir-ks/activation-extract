/usr/lib/python3/dist-packages/pytz/__init__.py:31: SyntaxWarning: invalid escape sequence '\s'
  match = re.match("^#\s*version\s*([0-9a-z]*)\s*$", line)
======================================================================
FINEWEB-EDU ACTIVATION EXTRACTION - MACHINE 0/0
======================================================================
{
  "machine_id": 0,
  "total_machines": 1,
  "model_path": "Qwen/Qwen2.5-7B",
  "dataset_name": "HuggingFaceFW/fineweb-edu",
  "dataset_config": "sample-10BT",
  "dataset_split": "train",
  "max_samples": 5,
  "layers_to_extract": [
    24,
    25,
    26,
    27
  ],
  "batch_size": 2,
  "max_seq_length": 512,
  "output_dir": "./test_activations_7b",
  "upload_to_gcs": false,
  "gcs_bucket": null,
  "gcs_prefix": "activations_fineweb",
  "shard_size_gb": 0.1,
  "compress_shards": true,
  "delete_local_after_upload": false,
  "verbose": true,
  "use_data_parallel": false
}
======================================================================
Traceback (most recent call last):
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 812, in backends
    backend = _init_backend(platform)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 896, in _init_backend
    backend = registration.factory()
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 217, in tpu_client_timer_callback
    client = make_tpu_client(
             ^^^^^^^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 193, in make_tpu_client
    _jax.initialize_pjrt_plugin('tpu')
jaxlib._jax.XlaRuntimeError: ABORTED: The TPU is already in use by process with pid 4154699. Not attempting to load libtpu.so in this process.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kathirks_gc/torch_xla/qwen/extract_activations_fineweb.py", line 852, in <module>
    main()
  File "/home/kathirks_gc/torch_xla/qwen/extract_activations_fineweb.py", line 720, in main
    devices = jax.devices()
              ^^^^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 1010, in devices
    return get_backend(backend).devices()
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 944, in get_backend
    return _get_backend_uncached(platform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 923, in _get_backend_uncached
    bs = backends()
         ^^^^^^^^^^
  File "/home/kathirks_gc/.local/lib/python3.12/site-packages/jax/_src/xla_bridge.py", line 828, in backends
    raise RuntimeError(err_msg)
RuntimeError: Unable to initialize backend 'tpu': ABORTED: The TPU is already in use by process with pid 4154699. Not attempting to load libtpu.so in this process. (set JAX_PLATFORMS='' to automatically choose an available backend)
